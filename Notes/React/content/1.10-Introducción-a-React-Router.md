## 1.10 Introducción a React Router

Las aplicaciones que se trabajan en React son llamadas single page apps. Esto es
posible gracias a React Router que es una librería Open Source. React Router
(v4): Nos da las herramientas para poder hacer SPA fácilmente. Usaremos 4
componentes:

> -   BrowserRouter: es un componente que debe estar siempre lo más arriba de la
>     aplicación. Todo lo que esté adentro funcionará como una SPA.
> -   Route: Cuando hay un match con el path, se hace render del component. El
>     component va a recibir tres props: match, history, location.
> -   Switch: Dentro de Switch solamente van elementos de Route. Switch se
>     asegura que solamente un Route se renderize.
> -   Link: Toma el lugar del elemento \<a\>, evita que se recargue la página
>     completamente y actualiza la URL.

### 1.10.1 Divison de la aplicación en rutas

Tenemos que importar los componentes, dentro de BrowserRouter solo debe haber un
elemento child, esto se soluciona metiendolos en un Switch, que solo permitirá
que se ejecute una sola ruta. El prefijo exact permite que se muestre el
componente solo si la ruta coincide al 100%

``` javascript
import { BrowserRouter, Route, Switch } from 'react-router-dom'

function App(){
    return (
        <BrowserRouter>
            <Switch>
                <Route exact path="/badges" component = {Badges} />
                <Route exact path="/badges/new" component = {BadgeNew} />
            <Switch>
        </BrowserRouter>  

    )
}
```

Es necesario sustituir todos los elementos a por Link, para evitar la recarga
completa de la página

``` javascript
import { Link } from 'react-router-dom'

<Link to="ruta/ruta">
```

### 1.10.2 Páginas 404

Esta es un ejemplo de como crear un 404

``` javascript
import { Redirect, Route } from "react-router-dom";

<Route path="/404" component={MiComponente404} />
<Redirect from="*" to="/404" />
```

### 1.10.3 Obtención de parametros de rutas

Los parametros de las rutas pueden obtenerse cuando estamos usando React Router
de la siguiente manera

``` javascript
this.props.match.params.parametroAObtener
```



## 1.10 React router

Reach Router es una versión simplificada y mejor optimizada de React
Router, su creador es Ryan Florence el mismo creador de React Router. Se
anunció que los dos paquetes se iban a unir, pero su API se va a parecer
más a Reach Router.

Al momento de escribir este apunte se instala así

``` javascript
npm i @reach/router
```

Y su uso es más simple que React/router. Aquí podemos indicarle la path
en la que se renderizará un componente directamente en el componente.
También cuenta con un componente redirect que redirige de una ruta a
otra.

``` javascript
<Router>
    <Home path='/'/>
    <Home path='/pet/:id'/>
    {!isAuth && <Redirect from='/favs' to='/login' />}
</Router>
```

Debemos cambiar la configuración de webpack

``` javascript
output: {
  filename: 'app.bundle.js',
  publicPath: '/'
},
```

Y el script de package.json que corre el servidor de desarrollo

``` javascript
"dev": "webpack serve --history-api-fallback",
```

### 1.10.1 Componente Link

Funciona igual que el de react router

``` javascript
import { Link } from '@reach/router'

<Link to={path}>

</Link>
```

##### 1.10.1.1.1 Obtener la página activa

@reach/router le añade el atributo aria-current="page" al componente
Link activo. Lo que nos permite darle estilos directamente buscando la
propiedad del componente y aplicandole estilos condicionales.

### 1.10.2 Renderizado condicional de rutas

Renderizar rutas de acuerdo a parametros tales como el estado de loggeo
se hace creando un componente que envolverá a otros componentes. En este
caso el componente UserLogged regresa el children y le pasa como
paramétro un objeto con isAuth.

``` javascript
const UserLogged = ({ children }) => {
  return children({ isAuth: false })
}
```

Nos asegurarnos de definir a children como una función, que reciba
parámetros y que retorne componentes. Usaremos el resultado del
parámetro creado para renderizar nuestros componentes envueltos en el
mismo objeto Router, como si se tratara de un router adicional al
principal.

``` javascript
<UserLogged>
  {
        ({ isAuth }) => isAuth
          ? <Router>
            <UserProfile path='/user' />
          </Router>
          : <Router>
            <LoginScreen path='/user' />
          </Router>
                  }
</UserLogged>
```

También es posible user el contexto para tener un código más ordenado

``` javascript
import React, {useContext} from 'react'
import Context from './Context'

const {isAuth} = useContext(Context)
<Router>
    {!isAuth && <Redirect from='/favs' to='/login' />}
</Router>
```

### 1.10.3 Páginas 404

React router puede especificar una página como default si no se
encuentra ninguna ruta colocandole un prop que diga default.

``` javascript
import { PageNotFound } from './pages/PageNotFound'

    <Router>
        <PageNotFound default/>
    </Router>
```
