## Preprocesar datasets

Los modelos de ML no pueden manejar strings(palabras) solo entienden números, así que si queremos suministrar una variable categórica a un modelo, primero debemos transformarla a número.

### to_categorical

En el caso de procesamiento de lenguaje natural a veces necesitamos transformar una entrada categórica en una representación similar a un array.

Ejemplo:

| Categoria | Valor   |
| --------- | ------- |
| Yes       | [1,0,0] |
| No        | [0,1,0] |
| Maybe     | [0,0,1] |


En código se vería de la siguiente manera

``` python
from keras.utils import to_categorical

dataset_processed = to_categorical(<dataset>)

dataset_processed[0]
# array([0,0,0...,1,0,0...])
```

Donde el array guarda una relación con las categorias y la presencia de un 1 índica que dicha data pertenece a esa categoria.

### Vectorización

Otra manera de prerocesar información es pasando una lista de palabras a una representación de vectores, donde cada palabra es correspondida con un número, a manera de diccionario.

``` python
def vectorizar(sequences, dim=<dimensiones>):
    restults = np.zeros((len(sequences),dim))
    for i, sequences in enumerate(sequences):
        restults[i,sequences]=1
    return restults     
```

### Normalización

A veces tenemos un conjunto de datos que númericamente presentan muchísima variación. 

Por ejemplo:

``` python
[0.1, 350, 0.2, 0.2, 25]
```

Para normalizar estas vamos a restarle la media aritmética a todos los datos y dividirlos por la desviación estándar.

``` python
mean = train_data.mean(axis=0)
train_data = train_data  - mean
std = train_data.std(axis=0)
train_data = train_data / std
```

Si se normalizan los datos, hay que recordar que la **data de prueba va a usar la media y la desviación estándar de la data de entrenamiento**. Porque se supone que no tenemos acceso a la data de entrenamiento.

``` python
test_data = test_data - mean
test_data = test_data / std
```