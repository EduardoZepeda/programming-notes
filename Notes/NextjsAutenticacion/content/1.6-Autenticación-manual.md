## 1.6 Autenticación manual

Provider usa oauth por debajo para manejar la autenticación. Si
accedemos a la propiedad *Credentials* seremos nosotros quienes nos
encargaremos de la autenticación.

``` javascript
providers: [Providers.Credentials({
    name: 'Nombre',
    credentials: {
        password: {
            type: 'password',
            label: 'Nunca pares de...'
        }
    },
    async authorize(credentials) {
        console.log(credentials)
    }
})]
```

### 1.6.1 Creando una pantalla de login

El campo credentials será un objeto con diferentes atributos html5, aqui
especificamos el password y el label. Nextjs se encargará de crear
automáticamente la página.

La configuración anterior creará una pantalla de loggeo de manera
automática en la ruta */api/auth/signin*

![image](Notes/NextjsAutenticacion/img/NextjsAuthSignin.png)

### 1.6.2 Función authorize

Dado que especificamos 'Nombre' como la propiedad name en el objeto
*providers* de *NextAuthOptions*, crearemos un archivo con el mismo
nombre dentro de *pages/api/auth/*, llamado Nombre.ts que contendrá la
función que usaremos para autentificar al usuario. En caso de que la
autenticación sea exitosa, retornaremos un usuario. Por favor **no uses
el mismo esquema que aquí, pues se compara el password directamente, sin
hashear**

``` javascript
import { NextApiHandler } from 'next'

const credentialsAuth: NextApiHandler<User> = (request, response) => {
    if (request.method!=='POST') {
        response.status(405).end()
        return
    }

    if (request.body.password === 'aprender') {
        const platziUser : User = {
            email: 'Platzi student',
            name: 'student@platzi.com',
            image: ''
        }
        return response.status(200).json(platziUser)
    }
    response.status(401).end()
}

export default credentialsAuth
```

